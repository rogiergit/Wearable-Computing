---
title: "README"
output: html_document
---

## Location of the run_analysis.R script
The Run_analysis script goes in the UCI directory which also contains the train and test folders


```r
setwd("E:\\Dev\\R\\Coursera\\3 Cleaning\\Wearable-Computing\\")
```


## Setting up packages and environment

```r
# Load packages we are going to work with
library(lubridate)      # Working with dates
library(dplyr)          # Working with tables
library(ggplot2)        # Working with plots
library(tidyr)          # Tidying data
library(plyr)
library(data.table)

# Set the locale the english
Sys.setlocale("LC_TIME", "English")
```



## 1. Merging the training and the test sets to create one data set.

### Reading the activity rows

```r
# Read the activity rows for test
activitytest<-read.table("./test/y_test.txt", header=F)

# Read the activity rows for train
activitytrain<-read.table("./train/y_train.txt", header=F)

# Add the test and train data together
activity<-rbind(activitytest, activitytrain)

# Check the rows structure
dim(activity) #10299 activity rows
```

```
## [1] 10299     1
```

```r
# Create a column name
colnames(activity)<- c("activityid")
```


## Reading the subject rows

```r
# Read the subject rows for test
subjecttest<-read.table("./test/subject_test.txt", header=F)

# Read the subject rows for train
subjecttrain<-read.table("./train/subject_train.txt", header=F)

# Add the test and train data together
subject<-rbind(subjecttest, subjecttrain)

# Check the rows structure
dim(subject)
```

```
## [1] 10299     1
```

```r
# Create a column name
colnames(subject)<- c("subject")
```

### Reading the featurelabels

```r
# Read the featurelabels for the columns of the test and train data
featurelabels<-read.table("features.txt", header=F, sep=" ")

# Check the structure
dim(featurelabels) #561 column labels
```

```
## [1] 561   2
```

```r
# Create column names
colnames(featurelabels)<-c("featurenr", "featurename")
```

### Read the test and train data

```r
# Read the x-test feature data
featurestest<-read.table("./test/x_test.txt", header=F)

# Read the x-train feature data
featurestrain<-read.table("./train/x_train.txt", header=F)

# Add the test and train data together
features<-rbind(featurestest, featurestrain)

# Check the structure
dim(features) #561 columns
```

```
## [1] 10299   561
```

### Create the combined dataset

```r
# Create column names for the featurelabels
# Ensure that the column names are unique, otherwise we'll encounter errors later when merging
colnames(features) <- make.names(featurelabels$featurename, unique=TRUE)

# add the activity, subject feature data together
data<-cbind(activity, subject, features)

# Recheck the structure
dim(data)
```

```
## [1] 10299   563
```




# 2. Extract only the measurements on the mean and standard deviation for each measurement. 

```r
# Create a new table containing only columns with subjects, activityid, mean and std
datameanstd <- select(data,matches("subject|activityid|mean|std"))

# Check the structure
dim(datameanstd)
```

```
## [1] 10299    88
```


# 3. Uses descriptive activity names to name the activities in the data set

```r
# Read the labels for the activities
activitylabels<-read.table("activity_labels.txt", header=F, sep=" ")

# Check the structure
head(activitylabels)
```

```
##   V1                 V2
## 1  1            WALKING
## 2  2   WALKING_UPSTAIRS
## 3  3 WALKING_DOWNSTAIRS
## 4  4            SITTING
## 5  5           STANDING
## 6  6             LAYING
```

```r
# Create column names for activity labels
colnames(activitylabels)<- c("activityid","activity")

# Add the activity label to the dataset using a merge on activityid
data <- merge(x=datameanstd, y=activitylabels, by="activityid")

# Check that activity has been merged correctly
unique(data[,c("activity")])
```

```
## [1] WALKING            WALKING_UPSTAIRS   WALKING_DOWNSTAIRS
## [4] SITTING            STANDING           LAYING            
## 6 Levels: LAYING SITTING STANDING WALKING ... WALKING_UPSTAIRS
```

```r
# Exclude the activityid field
data <- select(data, -activityid)

# Reorder the columns so that the dataset starts with subject and activity
data<-select(data, subject, activity, 2:87)

# Check the structure
dim(data)
```

```
## [1] 10299    88
```

```r
str(data)
```

```
## 'data.frame':	10299 obs. of  88 variables:
##  $ subject                             : int  7 21 7 7 18 7 7 7 11 21 ...
##  $ activity                            : Factor w/ 6 levels "LAYING","SITTING",..: 4 4 4 4 4 4 4 4 4 4 ...
##  $ tBodyAcc.mean...X                   : num  0.269 0.262 0.238 0.245 0.249 ...
##  $ tBodyAcc.mean...Y                   : num  0.00789 -0.01622 0.0021 -0.03155 -0.02112 ...
##  $ tBodyAcc.mean...Z                   : num  -0.0507 -0.1145 -0.0499 -0.1814 -0.1249 ...
##  $ tBodyAcc.std...X                    : num  -0.264 -0.415 -0.338 -0.311 -0.491 ...
##  $ tBodyAcc.std...Y                    : num  0.0324 0.1461 0.0563 0.0977 -0.1977 ...
##  $ tBodyAcc.std...Z                    : num  0.10128 -0.10997 0.00291 0.09829 -0.58428 ...
##  $ tGravityAcc.mean...X                : num  0.959 0.847 0.969 0.958 0.945 ...
##  $ tGravityAcc.mean...Y                : num  -0.184 -0.384 -0.183 -0.184 -0.237 ...
##  $ tGravityAcc.mean...Z                : num  -0.00944 -0.23933 -0.00224 -0.00334 0.10031 ...
##  $ tGravityAcc.std...X                 : num  -0.985 -0.99 -0.969 -0.989 -0.988 ...
##  $ tGravityAcc.std...Y                 : num  -0.99 -0.989 -0.9 -0.991 -0.974 ...
##  $ tGravityAcc.std...Z                 : num  -0.957 -0.976 -0.941 -0.935 -0.976 ...
##  $ tBodyAccJerk.mean...X               : num  0.3385 0.0133 0.3759 -0.2658 0.132 ...
##  $ tBodyAccJerk.mean...Y               : num  -0.5209 0.3167 0.0819 0.1414 0.2389 ...
##  $ tBodyAccJerk.mean...Z               : num  0.0602 -0.1015 -0.0292 0.318 -0.0623 ...
##  $ tBodyAccJerk.std...X                : num  -0.268 -0.307 -0.346 -0.354 -0.493 ...
##  $ tBodyAccJerk.std...Y                : num  0.0823 0.1793 0.0613 0.1009 -0.2339 ...
##  $ tBodyAccJerk.std...Z                : num  -0.158 -0.362 -0.28 -0.145 -0.7 ...
##  $ tBodyGyro.mean...X                  : num  -0.10582 0.02902 0.20912 -0.04965 -0.00734 ...
##  $ tBodyGyro.mean...Y                  : num  -0.0136 -0.098 -0.1452 -0.0874 -0.1364 ...
##  $ tBodyGyro.mean...Z                  : num  0.1441 0.029 -0.0385 0.0581 0.0996 ...
##  $ tBodyGyro.std...X                   : num  -0.456 -0.431 -0.416 -0.452 -0.653 ...
##  $ tBodyGyro.std...Y                   : num  -0.174 -0.414 -0.149 -0.136 -0.55 ...
##  $ tBodyGyro.std...Z                   : num  -0.348 -0.25 -0.397 -0.394 -0.575 ...
##  $ tBodyGyroJerk.mean...X              : num  -0.0497 -0.054 -0.2218 -0.1815 -0.0812 ...
##  $ tBodyGyroJerk.mean...Y              : num  -0.4349 -0.0727 -0.2108 0.3012 0.031 ...
##  $ tBodyGyroJerk.mean...Z              : num  0.21371 -0.095621 0.05902 -0.000464 -0.001021 ...
##  $ tBodyGyroJerk.std...X               : num  -0.0468 -0.1447 -0.1348 -0.061 -0.4653 ...
##  $ tBodyGyroJerk.std...Y               : num  -0.0638 -0.5364 -0.1239 -0.0829 -0.7853 ...
##  $ tBodyGyroJerk.std...Z               : num  -0.325 -0.441 -0.365 -0.381 -0.683 ...
##  $ tBodyAccMag.mean..                  : num  -0.0527 -0.1468 -0.1175 -0.0683 -0.3928 ...
##  $ tBodyAccMag.std..                   : num  -0.191 -0.354 -0.231 -0.184 -0.516 ...
##  $ tGravityAccMag.mean..               : num  -0.0527 -0.1468 -0.1175 -0.0683 -0.3928 ...
##  $ tGravityAccMag.std..                : num  -0.191 -0.354 -0.231 -0.184 -0.516 ...
##  $ tBodyAccJerkMag.mean..              : num  -0.151 -0.135 -0.215 -0.163 -0.439 ...
##  $ tBodyAccJerkMag.std..               : num  0.0756 -0.1427 -0.0429 0.0328 -0.4684 ...
##  $ tBodyGyroMag.mean..                 : num  -0.278 -0.278 -0.196 -0.269 -0.52 ...
##  $ tBodyGyroMag.std..                  : num  -0.0832 -0.433 -0.1161 -0.0676 -0.647 ...
##  $ tBodyGyroJerkMag.mean..             : num  -0.228 -0.417 -0.27 -0.222 -0.662 ...
##  $ tBodyGyroJerkMag.std..              : num  0.1026 -0.46407 0.00768 0.0401 -0.74075 ...
##  $ fBodyAcc.mean...X                   : num  -0.277 -0.408 -0.329 -0.294 -0.471 ...
##  $ fBodyAcc.mean...Y                   : num  0.0391 0.1639 0.1228 0.1135 -0.2011 ...
##  $ fBodyAcc.mean...Z                   : num  0.00668 -0.25762 -0.08493 0.02308 -0.60115 ...
##  $ fBodyAcc.std...X                    : num  -0.259 -0.418 -0.341 -0.318 -0.499 ...
##  $ fBodyAcc.std...Y                    : num  -0.0365 0.0637 -0.0485 0.0195 -0.2463 ...
##  $ fBodyAcc.std...Z                    : num  0.0664 -0.1017 -0.0279 0.053 -0.6074 ...
##  $ fBodyAcc.meanFreq...X               : num  -0.278 -0.185 -0.224 -0.2 -0.448 ...
##  $ fBodyAcc.meanFreq...Y               : num  0.2189 0.1593 0.0557 0.0555 0.072 ...
##  $ fBodyAcc.meanFreq...Z               : num  0.2148 0.0947 -0.0221 0.1534 0.0455 ...
##  $ fBodyAccJerk.mean...X               : num  -0.337 -0.342 -0.377 -0.38 -0.483 ...
##  $ fBodyAccJerk.mean...Y               : num  0.01362 0.07445 0.02506 0.00876 -0.32625 ...
##  $ fBodyAccJerk.mean...Z               : num  -0.0791 -0.336 -0.2238 -0.0366 -0.659 ...
##  $ fBodyAccJerk.std...X                : num  -0.261 -0.332 -0.371 -0.384 -0.552 ...
##  $ fBodyAccJerk.std...Y                : num  0.0863 0.2162 0.0291 0.1292 -0.1848 ...
##  $ fBodyAccJerk.std...Z                : num  -0.235 -0.384 -0.333 -0.253 -0.742 ...
##  $ fBodyAccJerk.meanFreq...X           : num  -0.329 -0.174 -0.263 -0.331 -0.244 ...
##  $ fBodyAccJerk.meanFreq...Y           : num  -0.263 -0.434 -0.377 -0.419 -0.472 ...
##  $ fBodyAccJerk.meanFreq...Z           : num  0.0438 -0.2644 -0.2699 0.1048 -0.0641 ...
##  $ fBodyGyro.mean...X                  : num  -0.218 -0.19 -0.185 -0.241 -0.539 ...
##  $ fBodyGyro.mean...Y                  : num  -0.0692 -0.3884 -0.0481 -0.0403 -0.6357 ...
##  $ fBodyGyro.mean...Z                  : num  -0.253 -0.243 -0.31 -0.327 -0.548 ...
##  $ fBodyGyro.std...X                   : num  -0.534 -0.51 -0.491 -0.52 -0.689 ...
##  $ fBodyGyro.std...Y                   : num  -0.252 -0.434 -0.223 -0.208 -0.507 ...
##  $ fBodyGyro.std...Z                   : num  -0.441 -0.321 -0.483 -0.473 -0.623 ...
##  $ fBodyGyro.meanFreq...X              : num  0.2159 0.0505 0.0149 0.2452 0.0361 ...
##  $ fBodyGyro.meanFreq...Y              : num  0.467 -0.129 0.111 0.33 -0.513 ...
##  $ fBodyGyro.meanFreq...Z              : num  0.209 -0.31 0.215 0.046 -0.318 ...
##  $ fBodyAccMag.mean..                  : num  -0.163 -0.361 -0.148 -0.166 -0.463 ...
##  $ fBodyAccMag.std..                   : num  -0.333 -0.45 -0.402 -0.32 -0.623 ...
##  $ fBodyAccMag.meanFreq..              : num  0.0742 0.2281 0.1961 0.2183 0.0915 ...
##  $ fBodyBodyAccJerkMag.mean..          : num  0.07021 -0.21814 -0.02705 -0.00175 -0.50183 ...
##  $ fBodyBodyAccJerkMag.std..           : num  0.0781 -0.0583 -0.068 0.068 -0.4311 ...
##  $ fBodyBodyAccJerkMag.meanFreq..      : num  -0.0406 0.2999 0.0537 -0.0905 0.0846 ...
##  $ fBodyBodyGyroMag.mean..             : num  -0.0327 -0.4858 -0.0451 -0.0359 -0.6719 ...
##  $ fBodyBodyGyroMag.std..              : num  -0.287 -0.494 -0.333 -0.258 -0.69 ...
##  $ fBodyBodyGyroMag.meanFreq..         : num  0.3971 0.4135 0.3345 0.4143 0.0353 ...
##  $ fBodyBodyGyroJerkMag.mean..         : num  0.0127 -0.5613 -0.0222 -0.0623 -0.7403 ...
##  $ fBodyBodyGyroJerkMag.std..          : num  0.1383 -0.3929 -0.0248 0.0916 -0.7591 ...
##  $ fBodyBodyGyroJerkMag.meanFreq..     : num  -0.12175 0.34638 -0.00087 -0.01887 0.10134 ...
##  $ angle.tBodyAccMean.gravity.         : num  0.12 0.48 0.284 0.136 0.499 ...
##  $ angle.tBodyAccJerkMean..gravityMean.: num  -0.5002 0.3557 -0.7969 0.7008 -0.0655 ...
##  $ angle.tBodyGyroMean.gravityMean.    : num  0.798 -0.844 -0.865 0.595 -0.548 ...
##  $ angle.tBodyGyroJerkMean.gravityMean.: num  -0.1665 -0.8074 0.2847 0.255 -0.0387 ...
##  $ angle.X.gravityMean.                : num  -0.838 -0.558 -0.84 -0.838 -0.767 ...
##  $ angle.Y.gravityMean.                : num  0.21 0.35 0.208 0.21 0.246 ...
##  $ angle.Z.gravityMean.                : num  0.0283 0.1894 0.0233 0.0241 -0.048 ...
```



# 4. Appropriately labels the data set with descriptive variable names. 

```r
# Get the column names and make them unique
colnames <-colnames(data)
colnames <- make.names(colnames, unique=TRUE)

#Cleanup the variable names by replacing characters
colnamesclean<-gsub("-", " ", colnames) #Rplace - with a space
colnamesclean<-gsub("\\.", " ", colnamesclean) #Replace . with a space
colnamesclean<-gsub("\\  ", " ", colnamesclean) #Replace . with a space
colnamesclean<-gsub("\\  ", " ", colnamesclean) #Replace . with a space
colnamesclean<-gsub("\\  ", " ", colnamesclean) #Replace . with a space
colnamesclean<-gsub("tBody", "Body", colnamesclean) #Remove the t
colnamesclean<-gsub("tGravity", "Gravity", colnamesclean) #Remove the t
colnamesclean<-gsub("fBody", "Body", colnamesclean) #Remove the f
colnamesclean<-gsub("BodyBody", "Body", colnamesclean) #Remove double Body
colnamesclean<-gsub("^\\s+|\\s+$", "", colnamesclean) #Strip leading and trailing spaces

# Recreate the column names for the dataset
colnames(data) <- colnamesclean

# Check the structure
str(data)
```

```
## 'data.frame':	10299 obs. of  88 variables:
##  $ subject                           : int  7 21 7 7 18 7 7 7 11 21 ...
##  $ activity                          : Factor w/ 6 levels "LAYING","SITTING",..: 4 4 4 4 4 4 4 4 4 4 ...
##  $ BodyAcc mean X                    : num  0.269 0.262 0.238 0.245 0.249 ...
##  $ BodyAcc mean Y                    : num  0.00789 -0.01622 0.0021 -0.03155 -0.02112 ...
##  $ BodyAcc mean Z                    : num  -0.0507 -0.1145 -0.0499 -0.1814 -0.1249 ...
##  $ BodyAcc std X                     : num  -0.264 -0.415 -0.338 -0.311 -0.491 ...
##  $ BodyAcc std Y                     : num  0.0324 0.1461 0.0563 0.0977 -0.1977 ...
##  $ BodyAcc std Z                     : num  0.10128 -0.10997 0.00291 0.09829 -0.58428 ...
##  $ GravityAcc mean X                 : num  0.959 0.847 0.969 0.958 0.945 ...
##  $ GravityAcc mean Y                 : num  -0.184 -0.384 -0.183 -0.184 -0.237 ...
##  $ GravityAcc mean Z                 : num  -0.00944 -0.23933 -0.00224 -0.00334 0.10031 ...
##  $ GravityAcc std X                  : num  -0.985 -0.99 -0.969 -0.989 -0.988 ...
##  $ GravityAcc std Y                  : num  -0.99 -0.989 -0.9 -0.991 -0.974 ...
##  $ GravityAcc std Z                  : num  -0.957 -0.976 -0.941 -0.935 -0.976 ...
##  $ BodyAccJerk mean X                : num  0.3385 0.0133 0.3759 -0.2658 0.132 ...
##  $ BodyAccJerk mean Y                : num  -0.5209 0.3167 0.0819 0.1414 0.2389 ...
##  $ BodyAccJerk mean Z                : num  0.0602 -0.1015 -0.0292 0.318 -0.0623 ...
##  $ BodyAccJerk std X                 : num  -0.268 -0.307 -0.346 -0.354 -0.493 ...
##  $ BodyAccJerk std Y                 : num  0.0823 0.1793 0.0613 0.1009 -0.2339 ...
##  $ BodyAccJerk std Z                 : num  -0.158 -0.362 -0.28 -0.145 -0.7 ...
##  $ BodyGyro mean X                   : num  -0.10582 0.02902 0.20912 -0.04965 -0.00734 ...
##  $ BodyGyro mean Y                   : num  -0.0136 -0.098 -0.1452 -0.0874 -0.1364 ...
##  $ BodyGyro mean Z                   : num  0.1441 0.029 -0.0385 0.0581 0.0996 ...
##  $ BodyGyro std X                    : num  -0.456 -0.431 -0.416 -0.452 -0.653 ...
##  $ BodyGyro std Y                    : num  -0.174 -0.414 -0.149 -0.136 -0.55 ...
##  $ BodyGyro std Z                    : num  -0.348 -0.25 -0.397 -0.394 -0.575 ...
##  $ BodyGyroJerk mean X               : num  -0.0497 -0.054 -0.2218 -0.1815 -0.0812 ...
##  $ BodyGyroJerk mean Y               : num  -0.4349 -0.0727 -0.2108 0.3012 0.031 ...
##  $ BodyGyroJerk mean Z               : num  0.21371 -0.095621 0.05902 -0.000464 -0.001021 ...
##  $ BodyGyroJerk std X                : num  -0.0468 -0.1447 -0.1348 -0.061 -0.4653 ...
##  $ BodyGyroJerk std Y                : num  -0.0638 -0.5364 -0.1239 -0.0829 -0.7853 ...
##  $ BodyGyroJerk std Z                : num  -0.325 -0.441 -0.365 -0.381 -0.683 ...
##  $ BodyAccMag mean                   : num  -0.0527 -0.1468 -0.1175 -0.0683 -0.3928 ...
##  $ BodyAccMag std                    : num  -0.191 -0.354 -0.231 -0.184 -0.516 ...
##  $ GravityAccMag mean                : num  -0.0527 -0.1468 -0.1175 -0.0683 -0.3928 ...
##  $ GravityAccMag std                 : num  -0.191 -0.354 -0.231 -0.184 -0.516 ...
##  $ BodyAccJerkMag mean               : num  -0.151 -0.135 -0.215 -0.163 -0.439 ...
##  $ BodyAccJerkMag std                : num  0.0756 -0.1427 -0.0429 0.0328 -0.4684 ...
##  $ BodyGyroMag mean                  : num  -0.278 -0.278 -0.196 -0.269 -0.52 ...
##  $ BodyGyroMag std                   : num  -0.0832 -0.433 -0.1161 -0.0676 -0.647 ...
##  $ BodyGyroJerkMag mean              : num  -0.228 -0.417 -0.27 -0.222 -0.662 ...
##  $ BodyGyroJerkMag std               : num  0.1026 -0.46407 0.00768 0.0401 -0.74075 ...
##  $ BodyAcc mean X                    : num  -0.277 -0.408 -0.329 -0.294 -0.471 ...
##  $ BodyAcc mean Y                    : num  0.0391 0.1639 0.1228 0.1135 -0.2011 ...
##  $ BodyAcc mean Z                    : num  0.00668 -0.25762 -0.08493 0.02308 -0.60115 ...
##  $ BodyAcc std X                     : num  -0.259 -0.418 -0.341 -0.318 -0.499 ...
##  $ BodyAcc std Y                     : num  -0.0365 0.0637 -0.0485 0.0195 -0.2463 ...
##  $ BodyAcc std Z                     : num  0.0664 -0.1017 -0.0279 0.053 -0.6074 ...
##  $ BodyAcc meanFreq X                : num  -0.278 -0.185 -0.224 -0.2 -0.448 ...
##  $ BodyAcc meanFreq Y                : num  0.2189 0.1593 0.0557 0.0555 0.072 ...
##  $ BodyAcc meanFreq Z                : num  0.2148 0.0947 -0.0221 0.1534 0.0455 ...
##  $ BodyAccJerk mean X                : num  -0.337 -0.342 -0.377 -0.38 -0.483 ...
##  $ BodyAccJerk mean Y                : num  0.01362 0.07445 0.02506 0.00876 -0.32625 ...
##  $ BodyAccJerk mean Z                : num  -0.0791 -0.336 -0.2238 -0.0366 -0.659 ...
##  $ BodyAccJerk std X                 : num  -0.261 -0.332 -0.371 -0.384 -0.552 ...
##  $ BodyAccJerk std Y                 : num  0.0863 0.2162 0.0291 0.1292 -0.1848 ...
##  $ BodyAccJerk std Z                 : num  -0.235 -0.384 -0.333 -0.253 -0.742 ...
##  $ BodyAccJerk meanFreq X            : num  -0.329 -0.174 -0.263 -0.331 -0.244 ...
##  $ BodyAccJerk meanFreq Y            : num  -0.263 -0.434 -0.377 -0.419 -0.472 ...
##  $ BodyAccJerk meanFreq Z            : num  0.0438 -0.2644 -0.2699 0.1048 -0.0641 ...
##  $ BodyGyro mean X                   : num  -0.218 -0.19 -0.185 -0.241 -0.539 ...
##  $ BodyGyro mean Y                   : num  -0.0692 -0.3884 -0.0481 -0.0403 -0.6357 ...
##  $ BodyGyro mean Z                   : num  -0.253 -0.243 -0.31 -0.327 -0.548 ...
##  $ BodyGyro std X                    : num  -0.534 -0.51 -0.491 -0.52 -0.689 ...
##  $ BodyGyro std Y                    : num  -0.252 -0.434 -0.223 -0.208 -0.507 ...
##  $ BodyGyro std Z                    : num  -0.441 -0.321 -0.483 -0.473 -0.623 ...
##  $ BodyGyro meanFreq X               : num  0.2159 0.0505 0.0149 0.2452 0.0361 ...
##  $ BodyGyro meanFreq Y               : num  0.467 -0.129 0.111 0.33 -0.513 ...
##  $ BodyGyro meanFreq Z               : num  0.209 -0.31 0.215 0.046 -0.318 ...
##  $ BodyAccMag mean                   : num  -0.163 -0.361 -0.148 -0.166 -0.463 ...
##  $ BodyAccMag std                    : num  -0.333 -0.45 -0.402 -0.32 -0.623 ...
##  $ BodyAccMag meanFreq               : num  0.0742 0.2281 0.1961 0.2183 0.0915 ...
##  $ BodyAccJerkMag mean               : num  0.07021 -0.21814 -0.02705 -0.00175 -0.50183 ...
##  $ BodyAccJerkMag std                : num  0.0781 -0.0583 -0.068 0.068 -0.4311 ...
##  $ BodyAccJerkMag meanFreq           : num  -0.0406 0.2999 0.0537 -0.0905 0.0846 ...
##  $ BodyGyroMag mean                  : num  -0.0327 -0.4858 -0.0451 -0.0359 -0.6719 ...
##  $ BodyGyroMag std                   : num  -0.287 -0.494 -0.333 -0.258 -0.69 ...
##  $ BodyGyroMag meanFreq              : num  0.3971 0.4135 0.3345 0.4143 0.0353 ...
##  $ BodyGyroJerkMag mean              : num  0.0127 -0.5613 -0.0222 -0.0623 -0.7403 ...
##  $ BodyGyroJerkMag std               : num  0.1383 -0.3929 -0.0248 0.0916 -0.7591 ...
##  $ BodyGyroJerkMag meanFreq          : num  -0.12175 0.34638 -0.00087 -0.01887 0.10134 ...
##  $ angle BodyAccMean gravity         : num  0.12 0.48 0.284 0.136 0.499 ...
##  $ angle BodyAccJerkMean gravityMean : num  -0.5002 0.3557 -0.7969 0.7008 -0.0655 ...
##  $ angle BodyGyroMean gravityMean    : num  0.798 -0.844 -0.865 0.595 -0.548 ...
##  $ angle BodyGyroJerkMean gravityMean: num  -0.1665 -0.8074 0.2847 0.255 -0.0387 ...
##  $ angle X gravityMean               : num  -0.838 -0.558 -0.84 -0.838 -0.767 ...
##  $ angle Y gravityMean               : num  0.21 0.35 0.208 0.21 0.246 ...
##  $ angle Z gravityMean               : num  0.0283 0.1894 0.0233 0.0241 -0.048 ...
```



## 5. Create tidy dataset from step 4
From the data set in step 4, create a second, independent tidy data set with the average of each variable for each activity and each subject

```r
# Create a datafram table (Dplyr)
tidy <- tbl_df(data)

# Create unique column names, otherwise the summary will give errors
colnames(tidy) <- make.names(colnames(tidy) , unique=TRUE)

# Group the data by subject and activity
tidygroup <-group_by(tidy, subject, activity)

# Calculate the mean for all features using a Dplyr function
tidymean <- summarise_each(tidygroup, funs(mean))

# Reapply the clean column names
colnames(tidymean) <- colnamesclean

# Check the first 10 rows and 6 columns
tidymean[1:10, 1:6]
```

```
## Source: local data frame [10 x 6]
## Groups: subject
## 
##    subject           activity BodyAcc mean X BodyAcc mean Y BodyAcc mean Z
## 1        1             LAYING      0.2215982   -0.040513953     -0.1132036
## 2        1            SITTING      0.2612376   -0.001308288     -0.1045442
## 3        1           STANDING      0.2789176   -0.016137590     -0.1106018
## 4        1            WALKING      0.2773308   -0.017383819     -0.1111481
## 5        1 WALKING_DOWNSTAIRS      0.2891883   -0.009918505     -0.1075662
## 6        1   WALKING_UPSTAIRS      0.2554617   -0.023953149     -0.0973020
## 7        2             LAYING      0.2813734   -0.018158740     -0.1072456
## 8        2            SITTING      0.2770874   -0.015687994     -0.1092183
## 9        2           STANDING      0.2779115   -0.018420827     -0.1059085
## 10       2            WALKING      0.2764266   -0.018594920     -0.1055004
## Variables not shown: BodyAcc std X (dbl)
```

```r
# Create tidy dataset from step 5
write.table(tidymean, file="tidy.txt", row.names=FALSE, col.names=TRUE, sep="\t", quote=TRUE)
```
